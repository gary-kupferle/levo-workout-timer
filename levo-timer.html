<!DOCTYPE html>
<!-- saved from url=(0047)http://mdn.github.io/beginner-html-site-styled/ -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>CrossFit Levo Workout Timer</title>
    <link href="css/css.css" rel="stylesheet" type="text/css">
    <link href="./css/style.css" rel="stylesheet" type="text/css">
</head>
<body>
<div>
    <img src="./images/levo-logo.png" alt="CrossFit Levo Logo" width="25%" height="25%" align="right">
    <h2>Raising Bars, Lifting Spirits</h2>
        <section>
            <div class="display" style="float:left">
                <label class="display-label" for="rounds">Rounds</label>
                <input type="number" id="rounds" value="1" default-value="0"/>
            </div>
            <div class="display" style="float:left">
                <label class="display-label" for="minutes">Minutes</label>
                <input type="number" id="minutes" value="0" min="0" max="60"/>
            </div>
            <div class="display" style="float:left;margin-right: 100px;">
                <label class="display-label" for="seconds">Seconds</label>
                <input type="number" id="seconds" value="0" min="0" max="60"/>
            </div>
        </section>
    <div>
        <button onclick="runTimer()" type="button" class="button">Start</button>
    </div>
    <section>
        <div class="display" style="float:left">
            <label class="display-label" for="rest">Rest</label>
            <input type="number" id="rest" value="0" default-value="0"/>
        </div>
        <div class="display" style="float:left">
            <label class="display-label" for="minutes">Minutes</label>
            <input type="number" id="minutes" value="0" min="0" max="60"/>
        </div>
        <div class="display" style="float:left;margin-right: 100px;">
            <label class="display-label" for="seconds">Seconds</label>
            <input type="number" id="seconds" value="0" min="0" max="60"/>
        </div>
    </section>

</div>

<audio id="audio-alarm">
    <source src="audio/alert.mp3" type="audio/mp3">
    Your browser does not support the audio element.
</audio>


<script>
  let audioAlarm = document.getElementById("audio-alarm");

  function playAudio() {
    audioAlarm.play();
  }

  function runTimer() {
    let rounds = document.getElementById("rounds");
    let minutes = document.getElementById("minutes");
    let seconds = document.getElementById("seconds");
    const minutesPerRound = minutes.value;
    const secondsPerRound = seconds.value;
    let countdownAmount = (1000 * 60 * minutes.value) + (1000 * seconds.value) + 1000;
    let now = new Date().getTime();
    let countdownTo = now + countdownAmount;

    // Update the count down every 0.1 second
    let timerInterval = setInterval(function () {
      now = new Date().getTime();

      // Find the distance between now and the count down date
      let distance = countdownTo - now;

      // Time calculations for days, hours, minutes and seconds
      minutes.value = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString();
      seconds.value = Math.floor((distance % (1000 * 60)) / 1000).toString();

      // If the count down is over, write some text
      if (distance < 1050 && rounds.value > 1) {
        playAudio();
        minutes.value = minutesPerRound;
        seconds.value = secondsPerRound;
        rounds.value = rounds.value - 1;
        now = new Date().getTime();
        countdownTo = now + countdownAmount;
      } else if (distance < 1050 && rounds.value >= 0) {
        playAudio();
        clearInterval(timerInterval);
        minutes.value = minutesPerRound;
        seconds.value = secondsPerRound;
        rounds.value = rounds.value - 1;
      }
    }, 100);
  }
</script>

</body>
</html>